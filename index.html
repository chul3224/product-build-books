<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>The Grimoire of Truth</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Crimson+Pro:ital,wght@0,400;0,700;1,400&family=Uncial+Antiqua&display=swap" rel="stylesheet">
    <style>
        :root {
            --book-bg: #2e0d0d;
            --parchment: #f2e8c9;
            --gold: #d4af37;
            --shadow: rgba(0, 0, 0, 0.8);
            
            /* 반응형 크기 설정 (화면 너비에 비례) */
            --book-w: 80vw;
            --book-h: 120vw;
            --max-w: 350px;
            --max-h: 500px;
        }

        /* PC 버전 고정 크기 제한 */
        @media (min-width: 600px) {
            :root {
                --book-w: 350px;
                --book-h: 500px;
            }
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            background-color: #050505;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden; touch-action: manipulation; /* 모바일 줌 방지 및 터치 최적화 */
            font-family: 'Crimson Pro', serif;
        }

        .magic-background {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a0f2e 0%, #000 100%);
            z-index: -1;
        }

        .scene {
            perspective: 2000px;
            width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center;
        }

        .book {
            width: var(--book-w);
            max-width: var(--max-w);
            height: var(--book-h);
            max-height: var(--max-h);
            position: relative;
            transform-style: preserve-3d;
            -webkit-transform-style: preserve-3d;
            transition: transform 2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 20px 50px var(--shadow);
        }

        /* 책이 열릴 때: 모바일에서는 화면 중앙을 유지하기 위해 최소한만 이동 */
        .book.open {
            transform: translateX(25%); /* 너비의 25%만 이동하여 좌우 균형 유지 */
        }
        @media (min-width: 600px) {
            .book.open { transform: translateX(50%); } /* PC에서는 반만큼 이동 */
        }

        .cover, .page-right {
            position: absolute;
            width: 100%; height: 100%;
            top: 0; left: 0;
            border-radius: 5px 15px 15px 5px;
            transform-origin: left;
            -webkit-transform-origin: left;
            transition: transform 2s ease-in-out;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .cover {
            z-index: 10;
            background: linear-gradient(135deg, #4a0e0e 0%, #2e0d0d 100%);
            border: 3px solid var(--gold);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; box-sizing: border-box;
        }

        .cover-title {
            font-family: 'Uncial Antiqua', cursive;
            color: var(--gold);
            font-size: 1.8rem; text-align: center;
            padding: 15px; text-shadow: 2px 2px 4px black;
        }

        .cover-inside {
            position: absolute; width: 100%; height: 100%;
            background: linear-gradient(to right, #e0d5b8, var(--parchment));
            transform: rotateY(180deg);
            -webkit-transform: rotateY(180deg);
            padding: 20px; box-sizing: border-box;
            border-radius: 15px 5px 5px 15px;
            display: flex; align-items: center; justify-content: center;
            border-right: 2px solid rgba(0,0,0,0.2);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .page-right {
            z-index: 1;
            background: linear-gradient(to left, #e0d5b8, var(--parchment));
            padding: 20px; box-sizing: border-box;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            box-shadow: inset 10px 0 30px rgba(0,0,0,0.3);
        }

        .parchment-text {
            font-size: clamp(1rem, 4vw, 1.4rem); /* 폰트 유동적 조절 */
            line-height: 1.5; color: #3d2b1f; text-align: center;
            font-style: italic; font-weight: 700;
            word-break: keep-all;
        }

        .next-btn {
            position: absolute; bottom: 15px; right: 15px;
            background: none; border: none; font-family: 'Cinzel', serif;
            color: #3d2b1f; font-size: 0.8rem; cursor: pointer; display: none;
        }

        #final-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 100; display: none; justify-content: center; align-items: center;
            flex-direction: column; background: radial-gradient(circle, #1a0f2e 0%, #000 100%);
            padding: 20px; box-sizing: border-box;
        }

        #final-answer {
            font-family: 'Uncial Antiqua', cursive;
            font-size: clamp(1.5rem, 6vw, 2.5rem);
            color: var(--gold); text-align: center; text-shadow: 0 0 20px var(--gold);
            line-height: 1.4; word-break: keep-all;
        }

        .retry-btn {
            margin-top: 30px; padding: 10px 25px;
            background: transparent; border: 1px solid var(--gold);
            color: var(--gold); font-family: 'Cinzel', serif; cursor: pointer;
        }

        /* 마법 플래시 효과 */
        @keyframes magicFlash {
            0% { background: white; opacity: 0; }
            50% { opacity: 1; }
            100% { background: transparent; opacity: 0; }
        }
        .flash { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 200; pointer-events: none; }
    </style>
</head>
<body>

<div class="magic-background"></div>
<div class="flash" id="flash"></div>

<div class="scene" id="main-scene">
    <div class="book" id="book" onclick="openBook()">
        <div class="cover" id="cover">
            <div class="cover-title">THE GRIMOIRE OF TRUTH</div>
            <div style="color:var(--gold); font-size:0.7rem; margin-top:10px;">[ Tap to Open ]</div>
            <div class="cover-inside">
                <p class="parchment-text">"해답은 이미 이 책의 갈피 속에 숨어 있습니다."</p>
            </div>
        </div>

        <div class="page-right">
            <div id="text-content" class="parchment-text"></div>
            <button class="next-btn" id="next-btn" onclick="nextStep(event)">Next ➔</button>
            <button id="magic-btn" class="retry-btn" style="display:none;" onclick="triggerMagic(event)">진실을 마주하라</button>
        </div>
    </div>
</div>

<div id="final-overlay">
    <div id="final-answer"></div>
    <button class="retry-btn" onclick="location.reload()">다시 질문하기</button>
</div>

<script>
    // 답변 배열은 동일
    const answers = ["무조건 추진하세요.", "당신의 선택이 옳습니다.", "지금이 바로 최고의 기회입니다.", "망설임 없이 나아가도 좋습니다.", "결과는 기대보다 훨씬 긍정적일 것입니다.", "기꺼이 받아들이세요.", "우주가 당신의 편을 들어주고 있습니다.", "분명히 좋은 결실을 맺을 것입니다.", "자신감을 가지고 결정하세요.", "예외 없이 'YES'입니다.", "당신의 직감이 정확합니다.", "거침없이 도전해도 되는 시기입니다.", "행운이 따르는 결정입니다.", "의심할 여지가 없습니다.", "아주 현명한 선택입니다.", "빛나는 결과가 기다리고 있습니다.", "확신을 가져도 좋습니다.", "이보다 더 좋을 순 없습니다.", "순풍에 돛 단 듯 잘 풀릴 것입니다.", "당신의 능력을 믿고 진행하세요.", "모든 조건이 완벽하게 갖춰졌습니다.", "긍정적인 변화가 시작될 것입니다.", "지금 당장 시작해도 좋습니다.", "승리는 당신의 것입니다.", "망설임은 시간 낭비일 뿐입니다.", "최고의 타이밍입니다.", "기쁜 소식이 곧 들려올 것입니다.", "당신의 선택에 박수를 보냅니다.", "생각한 대로 이루어질 것입니다.", "믿음직한 결과를 보게 될 것입니다.", "조금 더 신중할 필요가 있습니다.", "지금은 때가 아닙니다. 잠시 기다리세요.", "한 걸음 물러나서 전체를 바라보세요.", "숨겨진 위험 요소가 있는지 확인하세요.", "다른 대안을 찾아보는 건 어떨까요?", "서두르면 소중한 것을 놓칠 수 있습니다.", "원점에서 다시 검토해 보길 권합니다.", "아직은 준비가 더 필요한 단계입니다.", "이번에는 양보하는 것이 지혜롭습니다.", "직관이 거부한다면 따르지 마세요.", "너무 큰 기대는 실망을 부를 수 있습니다.", "계획의 구멍을 먼저 찾아내세요.", "감정에 치우친 결정은 아닌가요?", "주변의 반대를 무시하지 마세요.", "한 번 더 고민해 보는 시간이 필요합니다.", "지금의 열정은 일시적일 수 있습니다.", "무리한 진행은 화를 부를 수 있습니다.", "고집을 버리고 유연하게 생각하세요.", "조금 더 정보를 수집한 뒤 결정하세요.", "리스크를 감당할